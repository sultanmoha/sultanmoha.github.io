/* Custom styles for Bakery Delivery Tracker */

/* Remove default focus outline */
:focus {
    outline: none;
}

/* Accessible focus-visible ring */
:focus-visible {
    box-shadow: 0 0 0 3px rgba(16, 185, 129, .35);
    border-radius: .75rem;
}

/* Placeholder color */
input::placeholder,
textarea::placeholder {
    color: rgb(163, 163, 163);
}

/* Subtle page gradient */
body {
    background-image: radial-gradient(60% 60% at 10% 0%, rgba(16, 185, 129, .08), transparent 40%),
        radial-gradient(50% 50% at 90% 10%, rgba(59, 130, 246, .07), transparent 40%);
}

/* Badge styles for items/categories */
.badge {
    display: inline-block;
    padding: 0.15rem 0.4rem;
    border-radius: 0.375rem;
    font-size: 0.75rem;
    font-weight: 600;
    white-space: nowrap;
}

/* Compact badges only in Item Breakdown list */
#itemBreakdown .badge {
    padding-top: 0.08rem;
    padding-bottom: 0.08rem;
    line-height: 1.1;
}

/* Color palette for badges (will be applied via classes from script) */
.badge-color-0 {
    background-color: #e0f7fa;
    color: #006064;
}

.badge-color-1 {
    background-color: #e8f5e9;
    color: #1b5e20;
}

.badge-color-2 {
    background-color: #fff3e0;
    color: #e65100;
}

.badge-color-3 {
    background-color: #ede7f6;
    color: #4527a0;
}

.badge-color-4 {
    background-color: #fce4ec;
    color: #880e4f;
}

.badge-color-5 {
    background-color: #f3e5f5;
    color: #4a148c;
}

.badge-color-6 {
    background-color: #e8eaf6;
    color: #1a237e;
}

.badge-color-7 {
    background-color: #f1f8e9;
    color: #33691e;
}

.badge-color-8 {
    background-color: #f9fbe7;
    color: #827717;
}

.badge-color-9 {
    background-color: #e0f2f1;
    color: #004d40;
}

/* Dark mode */
.dark body {
    background-image: none;
    background-color: #1f2937;
    color: #e5e7eb;
}

/* Use Tailwind's built-in `hidden` utility; no override here. */

/* Neutral modal text colors for confirm dialogs.
   Titles and messages should remain neutral even for destructive actions. */
#confirmModalTitle {
    color: #111827;
}

#confirmModalMessage {
    color: #4b5563;
}

.dark #confirmModalTitle {
    color: #f3f4f6;
    /* neutral-100 in dark mode */
}

.dark #confirmModalMessage {
    color: #9ca3af;
    /* neutral-400 in dark mode */
}

/* Red border and shake animation for invalid form fields */
.border-red-500 {
    border-color: #ef4444 !important;
    /* red-500 */
}

@keyframes shake {
    0% {
        transform: translateX(0);
    }

    20% {
        transform: translateX(-4px);
    }

    40% {
        transform: translateX(4px);
    }

    60% {
        transform: translateX(-4px);
    }

    80% {
        transform: translateX(4px);
    }

    100% {
        transform: translateX(0);
    }
}

.shake-animation {
    animation: shake 0.4s ease;
}

.dark .bg-white {
    background-color: #111827;
}

.dark .border {
    border-color: #374151;
}

.dark .text-neutral-500 {
    color: #9ca3af;
}

.dark .text-neutral-600 {
    color: #6b7280;
}

.dark .text-neutral-700 {
    color: #4b5563;
}

.dark .text-neutral-800 {
    color: #374151;
}

.dark .text-neutral-900 {
    color: #f3f4f6;
}

.dark .bg-neutral-50 {
    background-color: #1f2937;
}

.dark .hover\:bg-neutral-50:hover {
    background-color: #374151;
}

.dark .bg-neutral-200 {
    background-color: #374151;
}

.dark .bg-neutral-300 {
    background-color: #4b5563;
}

.dark .bg-neutral-100 {
    background-color: #1f2937;
}

.dark .border-t {
    border-top-color: #374151;
}

.dark input,
.dark select,
.dark textarea {
    background-color: #1f2937;
    color: #e5e7eb;
    border-color: #374151;
}

.dark .focus-visible\:ring-emerald-400:focus-visible {
    box-shadow: 0 0 0 3px rgba(16, 185, 129, .35);
}

.dark .table-striped tbody tr:nth-child(odd) {
    background-color: #1f2937;
}

.dark .table-striped tbody tr:nth-child(even) {
    background-color: #111827;
}

/* Ensure hover text remains visible in dark mode (for elements using hover:text-neutral-900) */
.dark .hover\:text-neutral-900:hover {
    color: #f3f4f6 !important;
}

/* Shake animation for invalid inputs */
@keyframes shake {

    0%,
    100% {
        transform: translateX(0);
    }

    25% {
        transform: translateX(-4px);
    }

    75% {
        transform: translateX(4px);
    }
}

.animate-shake {
    animation: shake 0.3s ease-in-out;
}

/* Print styles */
.print-only {
    display: none;
}

@media print {

    .no-print,
    .print-hide {
        display: none !important;
    }

    /* Hide all action controls in the Transactions list on print */
    #transactionsList button,
    #transactionsList .actions,
    #transactionsList .action-col,
    #transactionsList [data-action],
    #transactionsList .btn {
        display: none !important;
    }

    body {
        background: white !important;
        color: black !important;
        margin: 0 !important;
        /* remove big top page gap */
        padding: 0 !important;
        /* ensure no top padding remains */
    }

    /* the fixed-nav spacer should not print */
    #navSpacer {
        display: none !important;
    }

    .no-print {
        display: none !important;
    }

    /* Show message only on print */
    .print-only {
        display: block !important;
    }

    /* Bootstrap-like alert styling for print */
    .alert {
        padding: 10px 12px;
        border: 1px solid #bbb;
        border-radius: 6px;
        font-size: 18px;
        margin-top: 8px;
    }

    .alert-success {
        background: #d1e7dd;
        color: #0f5132;
        border-color: #badbcc;
    }

    .alert-warning {
        background: #fff3cd;
        color: #664d03;
        border-color: #ffecb5;
    }

    .alert-info {
        background: #cff4fc;
        color: #055160;
        border-color: #b6effb;
    }

    .alert-danger {
        background: #f8d7da;
        color: #842029;
        border-color: #f5c2c7;
    }

    /* Emphasize the amount inside the alert */
    .alert .amount-emph {
        font-weight: 700;
    }

    .alert-warning .amount-emph {
        color: #664d03;
    }

    /* amber/due */
    .alert-info .amount-emph {
        color: #055160;
    }

    /* blue/credit */
    .alert-success .amount-emph {
        color: #0f5132;
    }

    /* green/settled */

    table {
        border-collapse: collapse;
        width: 100%;
        font-size: 10pt;
    }

    th,
    td {
        border: 1px solid #555;
        padding: 4px 6px;
    }

    thead th {
        background-color: #f0f0f0;
    }

    tbody tr:nth-child(odd) {
        background-color: #fafafa;
    }

    tbody tr:nth-child(even) {
        background-color: #ffffff;
    }

    .print-summary {
        margin-top: 1rem;
        font-size: 12pt;
        font-weight: bold;
    }
}

/* -----------------------------------------------
   More panel (light mode) hover color fix
   Ensures a light hover even if a nearby ancestor
   has `.dark`, but the page/root is in light mode.
------------------------------------------------ */
:root:not(.dark) #moreMenu [role="menuitem"]:hover {
    background-color: #f3f4f6 !important;
    /* neutral-100 */
    color: #111827 !important;
    /* neutral-900 */
}

/* Tighter printer page margins (top trimmed) */
@page {
    margin: 8mm 12mm 12mm 12mm;
    /* top, right, bottom, left */
}

/* Smooth micro-interactions */
.transition-base {
    transition: all .18s ease;
}

/* Custom dark mode toggle styles */
#darkToggle {
    width: 80px;
    height: 32px;
    border-radius: 9999px;
    border: 1px solid #d1d5db;
    background-color: #f5f5f5;
    position: relative;
    padding: 0;
    cursor: pointer;
    /* Smoothly transition background and border colors when toggling theme */
    transition: background-color 0.35s ease, border-color 0.35s ease;
}

/* Dark background for toggle container in dark mode */
.dark #darkToggle {
    background-color: #111827;
    border-color: #374151;
}

/* Common icon container */
#darkToggle .icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
}

/* Position the sun icon on the left */
#darkToggle .sun-icon {
    position: absolute;
    left: 8px;
    top: 50%;
    transform: translateY(-50%);
}

/* Position the moon icon on the right */
#darkToggle .moon-icon {
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%);
}

/* Knob for the dark toggle */
#darkToggle .knob {
    width: 28px;
    height: 28px;
    background-color: #ffffff;
    border-radius: 50%;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    position: absolute;
    top: 50%;
    left: 2px;
    transform: translateY(-50%);
    /* centers the knob vertically */
    transition: left 0.35s ease;
}

/* Knob position and color in dark mode */
.dark #darkToggle .knob {
    background-color: #f3f4f6;
    left: calc(100% - 28px - 2px);
    transform: translateY(-50%);
    /* keep centered in dark mode too */
}

/* Icon coloring: default (light mode) */
#darkToggle .sun-icon {
    color: #2563eb;
}

#darkToggle .moon-icon {
    color: #6b7280;
}

/* Icon coloring in dark mode: moon active */
.dark #darkToggle .sun-icon {
    color: #6b7280;
}

.dark #darkToggle .moon-icon {
    color: #2563eb;
}

/* Inline-edit visual cues */
td.editable {
    cursor: text;
}

td.editable:hover {
    background-color: rgba(16, 185, 129, .06);
}

.cell-editor {
    width: 100%;
    padding: .25rem .5rem;
    border: 1px solid rgb(212, 212, 212);
    border-radius: .5rem;
    box-shadow: inset 0 1px 0 rgba(0, 0, 0, .02);
}

.cell-editor:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, .25);
}

/* Validation error styles */
.invalid-input {
    border-color: rgb(239, 68, 68);
    /* red-500 */
}

@keyframes shake {

    0%,
    100% {
        transform: translateX(0);
    }

    20%,
    60% {
        transform: translateX(-4px);
    }

    40%,
    80% {
        transform: translateX(4px);
    }
}

.shake {
    animation: shake 0.3s ease;
}

/* Fix chart canvas height so charts remain compact even when Chart.js sets internal dimensions */
#deliveriesChart,
#revenueChart {
    height: 12rem !important;
    max-height: 12rem;
}


/* === Bakery Tracker Enhancements (2025-08-23) === */

/* 1) Deliveries Table: striped rows for readability (screen + print harmonized) */
.table-striped tbody tr:nth-child(odd) td,
.table-striped tbody tr:nth-child(odd) th {
    background-color: #f9fafb;
    /* light gray for odd rows (light mode) */
}

.dark .table-striped tbody tr:nth-child(odd) td,
.dark .table-striped tbody tr:nth-child(odd) th {
    background-color: #1f2937;
    /* slate-800 in dark mode */
}

.dark .table-striped tbody tr:nth-child(even) td,
.dark .table-striped tbody tr:nth-child(even) th {
    background-color: #111827;
    /* gray-900 in dark mode */
}

/* Also stripe the dynamic deliveries body via its ID, in case class isn't present */
#rowsBody tr:nth-child(odd) td,
#rowsBody tr:nth-child(odd) th {
    background-color: #f9fafb;
}

.dark #rowsBody tr:nth-child(odd) td,
.dark #rowsBody tr:nth-child(odd) th {
    background-color: #1f2937;
}

/* 2) Printing: utility classes already exist (.no-print, .print-hide). No new rules needed.
   We add them to key elements in index.html (dark toggle, shop filters, total profit card). */

/* 3) Dark Mode: increase contrast for faint buttons (Cancel, Back, Close) */
.dark button.bg-neutral-200,
.dark .bg-neutral-200 {
    background-color: #4b5563 !important;
    /* gray-600 */
    color: #f3f4f6 !important;
    /* gray-100 */
    border-color: #6b7280 !important;
    /* gray-500 */
}

.dark button.bg-neutral-200:hover,
.dark .bg-neutral-200:hover {
    background-color: #6b7280 !important;
    /* gray-500 */
}

/* Also make generic muted "text-neutral-500" buttons/links more legible when used as buttons */
.dark .btn-ghost,
.dark button.text-neutral-500,
.dark a.text-neutral-500 {
    color: #e5e7eb !important;
    /* gray-200 */
}

/* 4) Date input calendar icon visibility (WebKit-based browsers) */
input[type="date"]::-webkit-calendar-picker-indicator {
    opacity: 1;
    filter: none;
}

.dark input[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(1) contrast(1.2) brightness(1.1);
}

/* 5) Notes color in both light & dark modes */
td[data-field="notes"],
.note-text,
#notes {
    color: #D97707 !important;
    /* amber-600 */
}

/* 6) Modern, consistent modal styling (confirm & alert) */
#confirmModalBackdrop .rounded-2xl,
#alertModalBackdrop .rounded-2xl {
    backdrop-filter: blur(6px);
    border: 1px solid rgba(107, 114, 128, 0.4);
    /* gray-500 @ 40% */
}

/* === Redesigned navbar styles (2025-09-05) === */

/* Icon tabs for Deliveries & Purchases: transparent by default; rely on nav-with-label for hover */
.nav-tab {
    background-color: transparent;
    color: inherit;
}

.dark .nav-tab {
    background-color: transparent;
    color: inherit;
}

/* When active (aria-selected=true), apply blue background and white icon */
.nav-tab[aria-selected="true"] {
    background-color: #2563eb;
    color: #ffffff;
}

.dark .nav-tab[aria-selected="true"] {
    background-color: #2563eb;
    color: #ffffff;
}

/* Hover state: keep transparent; handled by nav-with-label */
.nav-tab:hover:not([aria-selected="true"]) {
    background-color: transparent;
}

.dark .nav-tab:hover:not([aria-selected="true"]) {
    background-color: transparent;
}

.nav-with-label {
    position: relative;
    width: 48px !important;
    /* was 44px */
    height: 48px !important;
    /* was 44px */
    border-radius: 9999px !important;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0 !important;
    color: #6b7280;
    transition: background-color .2s ease, color .2s ease, transform .2s ease;
}

/* Bigger icon inside the button */
.nav-with-label i {
    font-size: 1.6rem;
    /* was 1.35rem */
}

/* Light theme hover: soft blue background */
.nav-with-label:hover {
    background-color: transparent !important;
}

/* Dark theme hover: subtle neutral tint */
.dark .nav-with-label:hover {
    background-color: transparent !important;
}

/* Larger, more legible label pill under the icon */
.nav-with-label::after {
    content: attr(data-label);
    position: absolute;
    bottom: -2.55rem;
    left: 50%;
    transform: translate(-50%, 6px);
    padding: 6px 12px;
    font-size: 0.85rem;
    border-radius: 9999px;
    border: 1px solid #2563eb;
    background-color: #ffffff;
    color: #2563eb;
    opacity: 0;
    pointer-events: none;
    white-space: nowrap;
    transition: opacity .2s ease, transform .2s ease;
}

/* Dark mode variant */
.dark .nav-with-label::after {
    background: #0b1220;
    color: #93c5fd;
    border-color: rgba(59, 130, 246, .45);
    box-shadow: 0 6px 16px rgba(0, 0, 0, .4);
}

/* Show label on hover or keyboard focus */
.nav-with-label:hover::after,
.nav-with-label:focus-visible::after {
    opacity: 1;
    transform: translate(-50%, 0);
}

/* Keep labels hidden for the selected tab unless hovered/focused */
.nav-tab[aria-selected="true"]::after {
    opacity: 0;
}

.dark .nav-tab[aria-selected="true"]::after {
    opacity: 0;
}

/* Motion & touch preferences */
@media (prefers-reduced-motion: reduce) {
    .nav-with-label::after {
        transition: none;
    }
}

@media (hover: none) {
    .nav-with-label::after {
        display: none;
    }
}

/* Style generic action icons (save, print, clear, more, dark toggle, cloud sync) to match reference design */
#navSave,
#navPrint,
#navClear,
#navMore,
#navDark,
#cloudSyncBtn {
    width: auto;
    height: auto;
    padding: 0.5rem;
    border-radius: 0.375rem;
    background-color: transparent;
    color: #6b7280;
}

/* Destructive clear icon uses red coloring */
#navClear {
    color: #dc2626;
}

/* Dark mode uses lighter text colors */
.dark #navSave,
.dark #navPrint,
.dark #navClear,
.dark #navMore,
.dark #navDark,
.dark #cloudSyncBtn {
    color: #9ca3af;
}

.dark #navClear {
    color: #f87171;
}

/* Hover states for action icons */
#navSave:hover,
#navPrint:hover,
#navClear:hover,
#navMore:hover,
#navDark:hover,
#cloudSyncBtn:hover {
    background-color: #f3f4f6;
}

.dark #navSave:hover,
.dark #navPrint:hover,
.dark #navClear:hover,
.dark #navMore:hover,
.dark #navDark:hover,
.dark #cloudSyncBtn:hover {
    background-color: #4b5563;
}

/* Cloud status badge: small green dot with check inside */
/* Cloud status badge: green circle with white check */
#cloudStatusBadge {
    background-color: #22c55e;
    color: #ffffff;
}

/* Adjust search input placeholder color for better visibility */
#searchInput::placeholder {
    color: #9ca3af;
}

/* === Search input (scoped, light mode only) ================================== */
:root:not(.dark) #searchInput {
    background-color: #ffffff;
    color: #111827;
    border: 1px solid #d1d5db;
}

:root:not(.dark) #searchInput:hover {
    border-color: #cbd5e1;
}

/* Focus: single, subtle emerald accent without the extra dark edge */
:root:not(.dark) #searchInput:focus,
:root:not(.dark) #searchInput:focus-visible {
    outline: none;
    border-color: #10b981;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, .25) !important;
}

.dark #confirmModalBackdrop .rounded-2xl,
.dark #alertModalBackdrop .rounded-2xl {
    border-color: rgba(55, 65, 81, 0.8);
    /* gray-700 @ 80% */
}

/* Emphasize destructive action */
#confirmModalConfirm {
    background-color: #dc2626;
    /* red-600 */
}

#confirmModalConfirm:hover {
    background-color: #b91c1c;
    /* red-700 */
}

/* Ensure cancel/close buttons inside modals are clearly visible in dark mode */
.dark #modalCancel,
.dark #confirmModalCancel,
.dark #alertModalOk {
    background-color: #4b5563 !important;
    color: #f3f4f6 !important;
    border-color: #6b7280 !important;
}

.dark #modalCancel:hover,
.dark #confirmModalCancel:hover,
.dark #alertModalOk:hover {
    background-color: #6b7280 !important;
}

/* 7) Improve calendar icon hit area slightly */
input[type="date"] {
    padding-right: 2.25rem;
    /* room for the indicator */
}

/*
 * Align the calendar picker icon inside date inputs to the far right and vertically center it.
 * By default some browsers position the icon closer to the middle; this overrides that
 * behaviour for a consistent look across light and dark themes.
 */
input[type="date"] {
    position: relative;
}

input[type="date"]::-webkit-calendar-picker-indicator {
    position: absolute;
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    margin: 0;
}

/* In dark mode, inherit the icon colour using filter inversion defined above */
.dark input[type="date"]::-webkit-calendar-picker-indicator {
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    margin: 0;
}

/* ---- Print Summary (Deliveries) ---- */
@media print {
    #printSummary {
        display: block !important;
        page-break-inside: avoid;
        break-inside: avoid;
        margin-top: 12px;
    }

    #printSummary table {
        border-collapse: collapse;
        width: 100%;
    }

    #printSummary th,
    #printSummary td {
        border: 1px solid #555;
        padding: 4px 6px;
    }

    #printSummary thead th {
        background-color: #f0f0f0;
    }
}

/* --- Error tooltip (Calculate/Save) --- */
.btn-tooltip {
    position: absolute;
    z-index: 60;
    display: none;
    opacity: 0;
    padding: 12px 16px;
    /* bigger pill */
    border-radius: 9999px;
    /* pill */
    font-size: 14px;
    /* larger text */
    line-height: 1.3;
    transition: opacity .16s ease, transform .16s ease;
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, .12);
    white-space: nowrap;
}

.btn-tooltip.visible {
    display: block;
    transform: translateY(0);
    animation: tip-pop .16s ease;
}

@keyframes tip-pop {
    from {
        transform: translateY(-4px) scale(.98);
        opacity: 0;
    }

    to {
        transform: translateY(0) scale(1);
        opacity: 1;
    }
}

/* Solid red pill with white text */
.btn-tooltip--error {
    background: #DC2626;
    /* red-600 */
    color: #FFFFFF;
    /* white */
    border: 1px solid #B91C1C;
    /* red-700 */
}

.btn-tooltip--error .btn-tooltip-arrow {
    background: #DC2626;
    border-right: 1px solid #B91C1C;
    border-bottom: 1px solid #B91C1C;
}

.btn-tooltip .btn-tooltip-inner {
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-tooltip .btn-tooltip-inner i {
    font-size: 16px;
    /* bigger icon */
    line-height: 1;
    color: #FFFFFF;
}

/* placement arrow */
.btn-tooltip .btn-tooltip-arrow {
    position: absolute;
    width: 12px;
    height: 12px;
    left: 50%;
    transform: translateX(-50%) rotate(45deg);
}

.btn-tooltip[data-placement="top"] .btn-tooltip-arrow {
    bottom: -6px;
}

.btn-tooltip[data-placement="bottom"] .btn-tooltip-arrow {
    top: -6px;
}

/* Dark mode - keep strong red */
.dark .btn-tooltip--error {
    background: #DC2626;
    color: #FFFFFF;
    border-color: #B91C1C;
}

.dark .btn-tooltip--error .btn-tooltip-arrow {
    background: #DC2626;
    border-right-color: #B91C1C;
    border-bottom-color: #B91C1C;
}

/* Print */
@media print {
    .btn-tooltip {
        display: none !important;
    }
}

/* ===== Saves panel tabs ===== */
.saves-tab {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 12px;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    background: transparent;
    color: #6b7280;
    font-size: 0.875rem;
    /* text-sm */
    line-height: 1.2;
    transition: background-color .15s ease, color .15s ease, border-color .15s ease;
}

.saves-tab:hover {
    background: #f3f4f6;
    color: #111827;
    border-color: #e5e7eb;
}

.saves-tab--selected {
    background: #e5e7eb;
    color: #111827;
    border-color: #d1d5db;
}

.saves-tab--selected:hover {
    background: #e5e7eb;
    /* keep stable on hover for selected */
}

/* Counter “pill” — ensure correct colors in light & dark */
.saves-tab-count {
    display: inline-block;
    min-width: 20px;
    padding: 2px 8px;
    text-align: center;
    border-radius: 9999px;
    font-size: 0.75rem;
    /* text-xs */
    font-weight: 600;
    background: #e5e7eb;
    color: #1f2937;
}

/* Dark mode */
.dark .saves-tab {
    border-color: #374151;
    color: #cbd5e1;
}

.dark .saves-tab:hover {
    background: #1f2937;
    color: #e5e7eb;
    border-color: #374151;
}

.dark .saves-tab--selected {
    background: #374151;
    color: #e5e7eb;
    border-color: #4b5563;
}

.dark .saves-tab-count {
    background: #4b5563;
    color: #f3f4f6;
}

/* ================================
   Cloud Sync UI — Consolidated
   ================================ */

/* --- OneDrive-style icon-only button --- */
.cloud-btn {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 2.25rem;
    /* ~36px */
    width: 2.25rem;
    border-radius: 9999px;
    border: 1px solid #e5e7eb;
    background: #ffffff;
    color: #6b7280;
    /* default icon tint */
    box-shadow: 0 2px 10px rgba(0, 0, 0, .06);
    transition: background .15s ease, border-color .15s ease, color .15s ease, transform .12s ease;
}

.cloud-btn:hover {
    background: #f9fafb;
    border-color: #d1d5db;
    color: #374151;
    transform: translateY(-1px);
}

.cloud-btn:active {
    transform: translateY(0);
}

.cloud-btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, .35);
}

.dark .cloud-btn {
    background: #111827;
    border-color: #374151;
    color: #9ca3af;
    box-shadow: 0 10px 24px rgba(0, 0, 0, .25);
}

.dark .cloud-btn:hover {
    background: #0b1220;
    border-color: #4b5563;
    color: #e5e7eb;
}

/* Main cloud icon tint overrides based on state toggled on the button */
.cloud-btn.cloud-main-off i {
    color: #ef4444;
}

/* offline/error tint on main icon */
.cloud-btn.cloud-main-paused i {
    color: #f59e0b;
}

/* --- Status badge (overlay in top-right) --- */
/* Status badge (overlay in top-right) */
.cloud-badge {
    position: absolute;
    top: -2px;
    right: -2px;
    width: 1.1rem;
    /* equal width + height for perfect circle */
    height: 1.1rem;
    padding: 0;
    /* remove padding so it stays circular */
    border-radius: 9999px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: .7rem;
    line-height: 1;
    color: #ffffff;
    border: 2px solid #ffffff;
    background: #10b981;
    box-shadow: 0 4px 12px rgba(0, 0, 0, .18);
}

.dark .cloud-badge {
    border-color: #111827;
}

/* Badge state colors (JS toggles these classes) — updated palette */
.cloud-badge-ok {
    background-color: var(--bs-success, #198754) !important;
    color: #fff !important;
}

.cloud-badge-sync {
    background-color: #0d6efd !important;
    color: #fff !important;
}

.cloud-badge-paused {
    background-color: #ffc107 !important;
    color: #000 !important;
}

.cloud-badge-off {
    background-color: #6c757d !important;
    color: #fff !important;
}

/* keep .cloud-badge-blocked as-is for “needs sign-in/muted” */
.cloud-badge-err {
    background-color: #dc3545 !important;
    color: #fff !important;
}

/* --- Animations --- */
@keyframes cloud-spin {
    to {
        transform: rotate(360deg);
    }
}

@keyframes cloud-beat {

    0%,
    100% {
        transform: scale(1);
    }

    25% {
        transform: scale(1.08);
    }

    60% {
        transform: scale(0.98);
    }
}

.cloud-badge-spin {
    animation: cloud-spin .9s linear infinite;
}

.cloud-badge-beat {
    animation: cloud-beat 1.1s ease-in-out infinite;
}

/* --- Dropdown menu container --- */
.cloud-menu {
    position: absolute;
    right: 0;
    margin-top: .5rem;
    width: 14rem;
    /* 224px */
    background: #ffffff;
    border: 1px solid #e5e7eb;
    border-radius: .75rem;
    box-shadow: 0 12px 28px rgba(0, 0, 0, .12);
    padding: .5rem;
    z-index: 40;
}

.dark .cloud-menu {
    background: #0b1220;
    border-color: #1f2937;
    box-shadow: 0 18px 40px rgba(0, 0, 0, .55);
}

/* Menu items */
.cloud-item {
    width: 100%;
    display: flex;
    align-items: center;
    gap: .5rem;
    padding: .55rem .6rem;
    border-radius: .5rem;
    font-size: .95rem;
    color: #374151;
    background: transparent;
    transition: background .12s ease, color .12s ease, transform .1s ease;
}

.cloud-item i {
    width: 1rem;
    text-align: center;
}

.cloud-item:hover {
    background: #f3f4f6;
    color: #111827;
}

.cloud-item:active {
    transform: translateY(1px);
}

.dark .cloud-item {
    color: #d1d5db;
}

.dark .cloud-item:hover {
    background: #1f2937;
    color: #f3f4f6;
}

/* === Scoped hamburger (mobile) menu polish ===
   Match panel look/feel with light/dark theme, without affecting cloud menu */
#mobileMenu>div {
    /* Light theme panel (to match page) */
    background: #ffffff;
    /* mirrors bg-white */
    border: 1px solid #e5e7eb;
    /* mirrors border-neutral-200 */
    border-radius: .75rem;
    /* rounded-xl */
    box-shadow: 0 12px 28px rgba(0, 0, 0, .12);
}

/* Dark theme panel parity */
.dark #mobileMenu>div {
    background: #0b1220;
    /* mirrors dark:bg-neutral-900 */
    border-color: #1f2937;
    /* mirrors dark:border-neutral-700 */
    box-shadow: 0 18px 40px rgba(0, 0, 0, .55);
}

/* Scoped list item colors/hover so it always matches the page theme */
#mobileMenu .cloud-item {
    color: #374151;
    /* light text */
}

#mobileMenu .cloud-item:hover {
    background: #f3f4f6;
    color: #111827;
}

.dark #mobileMenu .cloud-item {
    color: #d1d5db;
    /* dark text */
}

.dark #mobileMenu .cloud-item:hover {
    background: #1f2937;
    color: #f3f4f6;
}

/* Divider inside menu (if not using utility classes) */
.cloud-menu .cloud-div {
    height: 1px;
    margin: .4rem 0;
    background: #e5e7eb;
}

.dark .cloud-menu .cloud-div {
    background: #374151;
}

/* --- Backups panel/list (View backups) --- */
.cloud-b-list {
    max-height: 16rem;
    overflow: auto;
}

.cloud-b-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: .75rem;
    padding: .6rem .85rem;
}

.cloud-b-item+.cloud-b-item {
    border-top: 1px solid #e5e7eb;
}

.dark .cloud-b-item+.cloud-b-item {
    border-color: #374151;
}

.cloud-b-name {
    font-weight: 600;
    max-width: 16rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.cloud-b-time {
    font-size: .75rem;
    color: #6b7280;
}

.dark .cloud-b-time {
    color: #9ca3af;
}

.cloud-b-restore {
    padding: .25rem .5rem;
    border-radius: .5rem;
    border: 1px solid #e5e7eb;
    font-size: .75rem;
    background: transparent;
    white-space: nowrap;
    transition: background .12s ease, border-color .12s ease, color .12s ease, transform .1s ease;
}

.cloud-b-restore:hover {
    background: #f3f4f6;
}

.dark .cloud-b-restore {
    border-color: #374151;
}

.dark .cloud-b-restore:hover {
    background: #1f2937;
}

/* --- Tooltip confirmations (fly-up toasts near the button) --- */
.cloud-tip {
    position: fixed;
    z-index: 60;
    background: #111827;
    /* base fallback */
    color: #f9fafb;
    border-radius: .5rem;
    padding: .45rem .6rem;
    font-size: .825rem;
    box-shadow: 0 8px 20px rgba(0, 0, 0, .25);
    opacity: 0;
    /* start slightly below, then rise to place */
    transform: translateY(6px);
    transition: opacity .18s ease, transform .18s ease;
}

.cloud-tip.show {
    opacity: 1;
    transform: translateY(0);
}

/* Tooltip palette (matches badges) */
.cloud-tip-ok {
    background-color: var(--bs-success, #198754);
    color: #fff;
}

.cloud-tip-sync {
    background-color: #0d6efd;
    color: #fff;
}

.cloud-tip-paused {
    background-color: #ffc107;
    color: #000;
}

.cloud-tip-off {
    background-color: #6c757d;
    color: #fff;
}

.cloud-tip-err {
    background-color: #dc3545;
    color: #fff;
}

.cloud-tip-muted {
    background-color: #6c757d;
    color: #fff;
}

/* Status color helpers for badges/rows */
.status-success {
    background-color: #198754 !important;
    color: #fff !important;
}

.status-sync {
    background-color: #0d6efd !important;
    color: #fff !important;
}

.status-paused {
    background-color: #ffc107 !important;
    color: #000 !important;
}

.status-error {
    background-color: #dc3545 !important;
    color: #fff !important;
}

.status-muted,
.status-offline {
    background-color: #6c757d !important;
    color: #fff !important;
}

/* --- Print: hide button and menu --- */
@media print {

    #cloudSyncBtn,
    #cloudSyncMenu {
        display: none !important;
    }
}

/* === Navbar panels: theme-synced surfaces & precise anchoring (2025-09-07) === */
:root {
    --surface-bg: #ffffff;
    --surface-border: #e5e7eb;
    --surface-hover: #f3f4f6;
    --surface-text: #111827;
}

.dark {
    --surface-bg: #0b1220;
    --surface-border: #1f2937;
    --surface-hover: #1f2937;
    --surface-text: #e5e7eb;
}

/* === Print-only caption for Deliveries table === */
@media print {
    table:has(> tbody#rowsBody)::before {
        content: "Deliveries";
        display: table-caption;
        caption-side: top;
        font-weight: 600;
        font-size: 14pt;
        margin-bottom: .5rem;
    }
}

/* === Transactions Table (foundation) ===================================== */

/* Container: allows horizontal scroll only when needed */
.txn-wrap {
    position: relative;
    width: 100%;
    overflow-x: auto;
    /* scroll only if the table exceeds width */
    -webkit-overflow-scrolling: touch;
}

/* Table: full width, compact, professional look */
.txn-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    min-width: 640px;
    /* allows scroll on narrow screens */
    background: var(--surface-bg, #fff);
    color: var(--surface-text, #111827);
    border: 1px solid var(--surface-border, #e5e7eb);
    border-radius: .75rem;
    overflow: hidden;
    /* round corners on the outer border */
}

/* Header */
.txn-table thead th {
    position: sticky;
    top: 0;
    background: var(--surface-hover, #f3f4f6);
    color: inherit;
    font-weight: 600;
    text-align: left;
    font-size: .9rem;
    padding: .65rem .75rem;
    border-bottom: 1px solid var(--surface-border, #e5e7eb);
    white-space: nowrap;
}

/* Body cells */
.txn-table tbody td {
    padding: .55rem .75rem;
    border-bottom: 1px solid var(--surface-border, #e5e7eb);
    vertical-align: middle;
    font-size: .92rem;
}

/* Zebra striping (screen + dark) */
.txn-table tbody tr:nth-child(odd) td {
    background: color-mix(in oklab, var(--surface-bg, #fff) 92%, #000 8%);
}

.dark .txn-table tbody tr:nth-child(odd) td {
    background: color-mix(in oklab, var(--surface-bg, #0b1220) 92%, #fff 8%);
}

/* Amount column right-aligned */
.txn-amount {
    text-align: right;
    font-variant-numeric: tabular-nums;
}

/* Action column: keep narrow on screen; hidden on print via your print rules */
.txn-actions {
    width: 1%;
    white-space: nowrap;
}

/* Focus states for action buttons in the table */
.txn-actions .btn,
.txn-actions button {
    outline: none;
}

.txn-actions .btn:focus-visible,
.txn-actions button:focus-visible {
    box-shadow: 0 0 0 3px rgba(37, 99, 235, .35);
    border-radius: .5rem;
}

/* Pills for Type (Payment/Deduction) and any future tags */
.pill {
    display: inline-flex;
    align-items: center;
    gap: .4rem;
    height: 1.5rem;
    padding: 0 .6rem;
    border-radius: 9999px;
    font-size: .78rem;
    font-weight: 600;
    line-height: 1;
    border: 1px solid transparent;
    white-space: nowrap;
}

/* Color-coded variants to match your palette */
.pill--pay {
    background: #e7f7ed;
    color: #0f5132;
    border-color: #bcdcc8;
}

/* success */
.pill--ded {
    background: #fde2e3;
    color: #842029;
    border-color: #f3b6b9;
}

/* danger */
.dark .pill--pay {
    background: #143227;
    color: #b6f0cf;
    border-color: #215842;
}

.dark .pill--ded {
    background: #3a0f12;
    color: #ffc2c6;
    border-color: #6a1b22;
}

/* Date & note columns: prevent squish while still wrapping notes when needed */
.txn-date {
    white-space: nowrap;
}

.txn-note {
    max-width: 28rem;
}

/* Footer row for totals (we will update via JS next step) */
.txn-table tfoot td {
    padding: .65rem .75rem;
    font-weight: 700;
    background: var(--surface-hover, #f3f4f6);
    border-top: 1px solid var(--surface-border, #e5e7eb);
}

/* Print tuning */
@media print {
    .txn-wrap {
        overflow: visible !important;
    }

    .txn-table {
        border-color: #bbb;
    }

    .txn-table thead th {
        background: #f2f2f2 !important;
        color: #000 !important;
    }

    .txn-actions,
    .txn-actions * {
        display: none !important;
    }

    /* NEW: show Type as plain colored text (no pill) */
    .pill {
        background: transparent !important;
        border-color: transparent !important;
        padding: 0 !important;
        border-radius: 0 !important;
        height: auto !important;
        line-height: normal !important;
        font-weight: 700;
        /* similar emphasis as other printed labels */
    }

    /* keep the text color from the variant classes */
    .pill--pay {
        color: #0f5132 !important;
    }

    .pill--ded {
        color: #842029 !important;
    }
}

/* Anchor panels to their trigger container */
.menu-panel {
    position: absolute;
    right: 0;
    /* default (mobile keeps right-edge anchoring) */
    top: calc(100% + .5rem);
    min-width: 11rem;
    background: var(--surface-bg);
    color: var(--surface-text);
    border: 1px solid var(--surface-border);
    border-radius: .75rem;
    box-shadow: 0 12px 28px rgba(0, 0, 0, .12);
    z-index: 40;
}

/* Desktop: center-align panels to their icon container and show a caret */
@media (min-width: 768px) {
    .menu-panel {
        left: 50%;
        right: auto;
        /* override any right:0 (e.g., utility classes) */
        transform: translateX(-50%);
    }

    /* Upward caret that matches the panel surface & border */
    .menu-panel::after {
        content: "";
        position: absolute;
        top: -6px;
        left: 50%;
        transform: translateX(-50%) rotate(45deg);
        width: 12px;
        height: 12px;
        background: var(--surface-bg);
        border-left: 1px solid var(--surface-border);
        border-top: 1px solid var(--surface-border);
        /* subtle lift so the caret sits cleanly against the panel */
        box-shadow: 0 -1px 0 rgba(0, 0, 0, 0.02) inset;
    }
}

/* Apply theme-surface to existing panels by ID to avoid touching JS/IDs */
#savePanel,
#purchaseSavePanel,
#moreMenu,
#cloudSyncMenu {
    background: var(--surface-bg) !important;
    color: var(--surface-text);
    border-color: var(--surface-border) !important;
    box-shadow: 0 12px 28px rgba(0, 0, 0, .12);
}

.dark #savePanel,
.dark #purchaseSavePanel,
.dark #moreMenu,
.dark #cloudSyncMenu {
    box-shadow: 0 18px 40px rgba(0, 0, 0, .55);
}


/* === Navbar icon hover/active animation (matches GIF) === */
.nav-with-label {
    position: relative;
    overflow: visible;
}

.nav-with-label::before {
    content: "";
    position: absolute;
    inset: -2px;
    border-radius: 9999px;
    background: #2563eb;
    transform: scale(.85);
    opacity: 0;
    transition: transform .18s ease, opacity .18s ease, box-shadow .18s ease;
    z-index: -1;
    box-shadow: 0 8px 20px rgba(37, 99, 235, .15);
}

.nav-with-label:hover::before {
    opacity: 1;
    transform: scale(1);
}

.nav-with-label:hover i {
    color: #ffffff !important;
}

/* Active (selected/open) state shares same blue circle */
.nav-with-label.is-active::before,
.nav-tab[aria-selected="true"]::before {
    opacity: 1;
    transform: scale(1);
}

.nav-with-label.is-active i,
.nav-tab[aria-selected="true"] i {
    color: #ffffff !important;
}

/* Clear action uses red circle on hover for affordance */
#navClear:hover::before {
    background: #dc2626;
    box-shadow: 0 8px 20px rgba(220, 38, 38, .22);
}

#navClear:hover i {
    color: #fff !important;
}

/* Position + size for the status badge (scaled up, spinner preserved) */
#cloudStatusBadge {
    position: absolute;
    top: 3px !important;
    right: 2px !important;
    width: 1.50rem;
    height: 1.50rem;
    border: 1px solid #ffffff;
    /* crisp ring */
    border-radius: 9999px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
    pointer-events: none;
    background: transparent;
    /* color comes from state classes */
}

#cloudStatusBadge i {
    font-size: .72rem;
    /* was .60rem (keeps icon proportional) */
    line-height: 1;
}

.dark #cloudStatusBadge {
    border-color: #111827;
}

/* Cloud button: revert circle size (badge stays enlarged) */
#cloudSyncBtn.nav-with-label,
#cloudSyncBtn.cloud-btn {
    width: 56px !important;
    height: 56px !important;
}

/* === Cloud status helpers (badges & inline status line) === */
.status-success {
    background-color: #198754 !important;
    color: #fff !important;
}

.status-sync {
    background-color: #0d6efd !important;
    color: #fff !important;
}

.status-paused {
    background-color: #ffc107 !important;
    color: #000 !important;
}

.status-error {
    background-color: #dc3545 !important;
    color: #fff !important;
}

.status-muted,
.status-offline {
    background-color: #6c757d !important;
    color: #fff !important;
}

/* Small inline status line inside the cloud menu */
.cloud-menu-status {
    display: block;
    margin: .25rem .25rem .5rem;
    padding: .25rem .5rem;
    border-radius: .5rem;
    font-size: .75rem;
    /* subtle */
    line-height: 1rem;
    white-space: nowrap;
}

/* Transactions table pills */
.pill {
    display: inline-flex;
    align-items: center;
    height: 1.4rem;
    padding: 0 .5rem;
    border-radius: 9999px;
    font-weight: 600;
    font-size: .75rem;
    line-height: 1
}

.pill-pay {
    background: #198754;
    color: #fff
}

.pill-deduct {
    background: #dc3545;
    color: #fff
}